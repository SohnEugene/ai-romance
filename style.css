/* AI Romance - Responsive Styles */

/* 배경 및 기본 설정 */
body {
    /* 기본 배경색 (이미지가 없을 때 보임) */
    background-color: #000;

    background-size: cover;             /* 화면 꽉 채우기 */
    background-position: center;        /* 중앙 정렬 */
    background-repeat: no-repeat;       /* 반복 안 함 */
    transition: background-image 0.5s ease-in-out; /* 배경 변경 시 부드러운 전환 효과 */

    /* 기존 레이아웃 설정 */
    margin: 0;
    padding: 0;
    min-height: 100vh;
    position: relative;

    /* 화면 크기에 따라 기본 폰트 사이즈 조절 */
    font-size: clamp(14px, 1.5vw, 18px);
    
    /* 텍스트 드래그 및 더블클릭 선택 방지 */
    -webkit-user-select: none; /* 크롬, 사파리 */
    -moz-user-select: none;    /* 파이어폭스 */
    -ms-user-select: none;     /* 인터넷 익스플로러/엣지 */
    user-select: none;         /* 표준 브라우저 */
}

/* 입력창(이름 입력 등)은 텍스트 선택/입력이 가능해야 함 */
input, textarea {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
}
/* story 컨테이너: 화면 하단 정렬 */
#story {
    width: 100%;
    height: 100vh; /* 전체 높이 사용 */
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: flex-end; /* 하단 정렬 */
    pointer-events: none; /* 배경 클릭 가능하게 하기 위해 컨테이너 클릭 통과 */
}

/* 텍스트 영역 레이아웃 */
#passages {
    width: 100%;
    max-width: 1000px; /* 너무 넓어지지 않게 제한 */
    margin: 0 auto;    /* 중앙 정렬 */
    margin-bottom: 2vh; /* 바닥에서 살짝 띄움 */
    position: relative;
    z-index: 10;
    pointer-events: auto; /* 텍스트 박스는 클릭 가능해야 함 */
}

.passage {
    /* 높이를 30vh로 유지하되, 최소 높이를 보장 */
    height: 30vh;
    min-height: 200px; /* 너무 작아지는 것 방지 */

    width: 90%;
    margin: 0 auto;

    /* 배경과 테두리를 함께 처리 */
    background:
        linear-gradient(to bottom, rgba(255, 255, 255, 0.95), rgba(230, 210, 255, 0.95)) padding-box,
        linear-gradient(135deg, #ff69b4, #d896ff) border-box;
    border: 5px solid transparent;
    border-radius: 15px;
    position: relative;

    /* 빛나는 효과 (box-shadow) */
    box-shadow:
        0 0 20px rgba(255, 105, 180, 0.4),
        0 0 40px rgba(216, 150, 255, 0.3),
        inset 0 -2px 10px rgba(216, 150, 255, 0.2);

    /* 패딩을 줄여서 글자가 들어갈 공간 확보 */
    padding: 2.2vh 1.8vw;
  	padding-bottom: 60px
    box-sizing: border-box;

    text-align: left;
    color: #000;

    /* 글자 크기와 줄 간격을 조금 더 타이트하게 조정 */
    font-size: clamp(14px, 1.1rem, 18px);
    line-height: 1.4;
	overflow: hidden !important; /* 스크롤 제거 */

}

/* 패시지 내부의 불필요한 문단 여백 제거 */
.passage p {
    margin-top: 0;
    margin-bottom: 0.5em; /* 문단 사이 간격을 최소화 */
    padding: 0;
}

/* 제목(h1~h6)이나 수평선(hr)이 있을 경우 여백 감소 */
.passage h1, .passage h2, .passage h3 { margin: 0.2em 0; }
.passage hr { margin: 0.5em 0; }
/* 스크롤바 디자인 (미관상 숨기거나 얇게 처리) */
.passage::-webkit-scrollbar {
    width: 1px;
}
.passage::-webkit-scrollbar-thumb {
    background-color: #ff69b4;
    border-radius: 4px;
}

.passage > br:first-child {
    display: none;
}

/* 배경 이미지 설정 */
body:has(.passage[data-tags~="bg1"]) {
    background-image: url('assets/background/bg1.png');
}

body:has(.passage[data-tags~="bg2"]) {
    background-image: url('assets/background/bg2.png');
}

body:has(.passage[data-tags~="bg3"]) {
    background-image: url('assets/background/bg3.png');
}

body:has(.passage[data-tags~="bg4"]) {
    background-image: url('assets/background/bg4.png');
}

body:has(.passage[data-tags~="bg5"]) {
    background-image: url('assets/background/bg5.png');
}

body:has(.passage[data-tags~="bg6"]) {
    background-image: url('assets/background/bg6.png');
}

body:has(.passage[data-tags~="bg7"]) {
    background-image: url('assets/background/bg7.png');
}

body:has(.passage[data-tags~="bg8"]) {
    background-image: url('assets/background/bg8.png');
}

body:has(.passage[data-tags~="bg9"]) {
    background-image: url('assets/background/bg9.png');
}

body:has(.passage[data-tags~="bg10"]) {
    background-image: url('assets/background/bg10.png');
}

body:has(.passage[data-tags~="bg11"]) {
    background-image: url('assets/background/bg11.png');
}

body:has(.passage[data-tags~="bg12"]) {
    background-image: url('assets/background/bg12.png');
}

body:has(.passage[data-tags~="bg13"]) {
    background-image: url('assets/background/bg13.png');
}

body:has(.passage[data-tags~="bg14"]) {
    background-image: url('assets/background/bg14.png');
}

body:has(.passage[data-tags~="bg15"]) {
    background-image: url('assets/background/bg15.png');
}

body:has(.passage[data-tags~="bg16"]) {
    background-image: url('assets/background/bg16.png');
}

body:has(.passage[data-tags~="bg17"]) {
    background-image: url('assets/background/bg17.png');
}

body:has(.passage[data-tags~="bg18"]) {
    background-image: url('assets/background/bg18.png');
}

/* 캐릭터 이미지 (중앙 하단 고정) */
#character-image {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    
    /* 화면 높이에 맞춰 이미지 크기 조절 */
    height: 70vh; 
    width: auto; /* 비율 유지 */
    max-width: 100%;
    
    object-fit: contain;
    z-index: 1;
    pointer-events: none;
}

/* 호감도 UI */
#right-sidebar {
    position: fixed;
    /* px 대신 vh, vw 단위를 사용하여 화면 비율에 따라 위치 조정 */
    top: 3vh; 
    right: 3vw;
    
    /* 너비를 화면 너비의 20%로 설정 (최소/최대 크기 제한) */
    width: 20vw; 
    min-width: 180px;
    max-width: 250px;

    padding: 1.5vh 1.5vw;
    
    background-color: rgba(0, 0, 0, 0.8);
    border: 2px solid #ff69b4;
    border-radius: 10px;
    z-index: 100;
    color: white;
    font-family: sans-serif;
    
    /* UI 내용물이 넘치지 않도록 박스 크기 계산 */
    box-sizing: border-box;
}

.sidebar-title {
    text-align: center;
    font-weight: bold;
    font-size: 1.1rem;
    margin-bottom: 1.5vh;
    border-bottom: 1px solid #555;
    padding-bottom: 1vh;
}

.char-box {
    margin-bottom: 1.5vh;
}

.char-name {
    display: inline-block;
    width: 30%;
    font-weight: bold;
    font-size: 1rem;
}

.char-score {
    float: right;
    font-size: 0.9rem;
    color: #ddd;
}

/* 게이지 바 */
progress {
    width: 100%;
    height: 1.5vh; /* 높이도 화면 비율에 맞춤 */
    appearance: none;
}

progress::-webkit-progress-bar {
    background-color: #444;
    border-radius: 5px;
}

progress::-webkit-progress-value {
    background-color: #ff69b4;
    border-radius: 5px;
    transition: width 0.5s;
}

#typewriter-box {
    font-family: 'Nanum Gothic', sans-serif;
    font-size: 1.2em;
    line-height: 1.4; /* 줄 간격 좁힘 */
    /* min-height: 100px; */
    white-space: pre-wrap;
    padding: 10px; /* 패딩 축소 */
    /* 배경색 제거 (대화창 배경과 통일감을 위해) */
    background-color: transparent; 
    color: #000; /* 글자색 검정 */
  
  	/* 텍스트 박스 자체 스크롤 허용 */
    width: 100%;
    height: 100%;
    overflow-y: auto;
    padding-right: 1px; /* 스크롤바 공간 */
}

/* 이름표 영역 (하단 바) */
#name-zone {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 45px; /* 이름표 높이 */
    
    /* 스타일 */
    background-color: rgba(255, 255, 255, 0.4); /* 연한 반투명 */
    border-top: 1px solid rgba(255, 255, 255, 0.6);
    border-radius: 0 0 13px 13px; /* 패시지 둥근 모서리에 맞춤 */
    
    display: flex;
    align-items: center;
    padding-left: 25px;
    box-sizing: border-box;
    
    color: #333;
    font-weight: bold;
    font-size: 1.1rem;
    pointer-events: none;
}

/* 링크 버튼 컨테이너 (이름표 바로 위에 고정) */
#next-btn {
    position: absolute;
    bottom: 55px; /* 이름표 높이(45px) + 간격(10px) */
    z-index: 20;
    

}

/* 현재 타이핑 중인 줄 */
.typing-line {
    margin: 0;
}

/* 문장 끝에 붙는 붓 아이콘 애니메이션 */
.next-icon {
    display: inline-block;
    margin-left: 8px;
    font-size: 1em;
    animation: blink-icon 1.5s infinite;
    cursor: pointer;
}

/* 아이콘 깜빡임 키프레임 */
@keyframes blink-icon {
    0%, 100% { opacity: 1; transform: translateY(0); }
    50% { opacity: 0.3; transform: translateY(-2px); }
}

/* 기본 Twine 스타일로 복구 */

/* 1. 스토리 컨테이너 정렬 변경 (하단 -> 중앙) */
body[data-tags~="Basic_style"] #story {
    align-items: center; /* 세로 중앙 정렬 */
}

/* 2. 패시지 상자 스타일 원상복구 (VN 스타일 해제) */
body[data-tags~="Basic_style"] .passage {
    height: auto;           /* 고정 높이(30vh) 해제 */
    min-height: 0;
    width: 50%;             /* 너비 적당히 조절 */
    max-width: 800px;
    
    background: transparent; /* 핑크색 배경 제거 */
    border: none;           /* 테두리 제거 */
    border-radius: 0;
    
    padding: 0;             /* 패딩 제거 */
    color: #eee;            /* 글자색 흰색으로 (배경이 검정이므로) */
    font-size: 100%;        /* 폰트 크기 기본으로 */
    overflow: visible;      /* 스크롤 제거 */
}

/* 세이브/로드 메뉴 (Pause Screen) */

/* 전체 화면을 덮는 오버레이 */
#pause-screen {
    display: none; /* 기본적으로 숨김 */
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.85); /* 반투명 검은 배경 */
    z-index: 100000; /* 최상단 노출 */
    
    /* 내용물 중앙 정렬 (Flexbox) */
    display: flex; 
    flex-direction: column;
    justify-content: center;
    align-items: center;
    
    color: #fff;
    font-family: 'Nanum Gothic', sans-serif;
}

/* 버튼 컨테이너 (세로 배치) */
.pause-buttons {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 40px;
    width: 200px;
}

/* 저장/불러오기 메인 버튼 */
.pause-main-btn {
    padding: 15px 0;
    font-size: 1.2rem;
    background: transparent;
    border: 2px solid #fff;
    color: #fff;
    cursor: pointer;
    transition: all 0.3s;
    border-radius: 5px;
}

.pause-main-btn:hover {
    background: #ff69b4;
    border-color: #ff69b4;
}

/* 슬롯 컨테이너 (가로 배치) */
.slot-container {
    display: flex;
    flex-direction: row;
    gap: 15px;
    width: 80%;
    justify-content: center;
}

/* 개별 슬롯 박스 */
.save-slot {
    width: 120px;
    height: 120px;
    border: 2px solid #555;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.1);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 0.9rem;
    transition: all 0.2s;
    text-align: center;
    padding: 5px;
    box-sizing: border-box;
}

/* 슬롯 마우스 오버 */
.save-slot:hover {
    border-color: #aaa;
    background: rgba(255, 255, 255, 0.2);
}

/* 선택된 슬롯 (강조) */
.save-slot.selected {
    border-color: #ff69b4;
    background: rgba(255, 105, 180, 0.2);
    box-shadow: 0 0 15px #ff69b4;
}

/* 슬롯 내부 텍스트 */
.slot-id { font-weight: bold; margin-bottom: 5px; }
.slot-info { font-size: 0.8rem; color: #ccc; }
.slot-empty { color: #666; font-style: italic; }

/* 안내 메시지 영역 */
#pause-message {
    margin-top: 20px;
    height: 20px;
    color: #ff69b4;
    font-weight: bold;
}

/* 기본 UI 숨기기 & 전체 레이아웃 보정 */

/* SugarCube 기본 사이드바 숨김 */
#ui-bar {
    display: none !important;
}

/* 사이드바가 사라진 만큼 본문 영역을 왼쪽으로 당김 */
#story {
    margin-left: 0 !important;
}

/* 모바일 등에서 생길 수 있는 여백 제거 */
body {
    margin: 0 !important;
    padding: 0 !important;
}

/* 일시정지 시 게임 화면 잠금 */

/* 'paused' 클래스가 붙으면 게임 내용물 클릭 불가 */
#story.paused {
    pointer-events: none; /* 마우스 클릭 차단 */
}
/* 메뉴 화면은 클릭이 가능해야 함 */
#pause-screen {
    pointer-events: auto;
}

/* =========================================
   [통합] 특수 연출 효과 (Visual Effects)
   ========================================= */

/* 1. 기절/암전용 검은 막 (Blackout Overlay) */
#blackout-overlay {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    z-index: 99990; /* 최상단 */
    background-color: #000;
    opacity: 0;
    pointer-events: none;
    /* 기본 트랜지션 없음 (JS에서 제어) */
}

/* 검은 막 활성화 (화면 가림) */
#blackout-overlay.active {
    opacity: 1;
    pointer-events: all; /* 클릭 차단 */
}

/* 2. 노이즈 글리치 막 (Glitch Overlay) */
#glitch-overlay {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
    z-index: 99991; /* 검은 막보다 위에 표시 */
    background-color: transparent;
    /* 노이즈 패턴 (Base64) */
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyBAMAAADsEZWjAAAAG1BMVEUaGhoHBwcdHR0gICAeHh4KCgoXFxcZGRkjIyNLCw6SAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVQ4jWNgwA2YljCgC4FYzIqKEBYzIgQXZIEgNlQhKyQhFiA7F6oQXRjEuFoQJkQZMHCgC4HYjIhiUGFjBKEQhI3gQhWCEFYGEA2yDBm4UIVg7FyoQhA2sgAIm0EAC0EIRNmMCIUgbAYBKIURhLChkK4wBCEgtoIqJIEgNogQyK7G5QIQLmSFIIStYAEQNoMAKMYKYYMog2wAELAwhCBsFgEQLmSFICwGQAhEGYgwhCAsFqgC7FykAhA2gwAIhSCEzSKEIQjB2Lg8gC6EFAQhEGUg2yAIi2G4AISwGSCIQhCCsRkQFkMYghAQC1SBIARiQwWCEIhBuACEYAxBCFjYQAjEhkqGEIhBuACEsLEAhBBkINsgCIFYYIEgBGIzIEC2gRCIsRkQICtBCMRmQoBsgSAEYjMgQLbBEAA1Y48Yg4H03gAAAABJRU5ErkJggg==');
    background-repeat: repeat;
    background-size: 128px 128px;
    opacity: 0;
    pointer-events: none;
    mix-blend-mode: hard-light; /* 배경과 섞이는 효과 */
}

/* 노이즈 활성화 */
#glitch-overlay.active {
    opacity: 0.8;
    animation: heavy-noise 0.1s infinite steps(1);
}

/* 노이즈 애니메이션 키프레임 */
@keyframes heavy-noise {
  0% { background-position: 0px 0px; transform: scale(1); }
  20% { background-position: 30px -10px; transform: scale(1.02); }
  40% { background-position: -30px 40px; transform: scale(0.98); }
  60% { background-position: 40px -40px; transform: scale(1.01); }
  80% { background-position: -20px 20px; transform: scale(0.99); }
  100% { background-position: 10px 30px; transform: scale(1); }
}

/* 3. 본문 블러 효과 (Story Blur) */
#story {
    transition: filter 0s; /* 기본은 즉시 변경 */
}

/* 블러 클래스 (3초 동안 천천히 흐려짐) */
#story.blur-active {
    transition: filter 3s ease-in;
    filter: blur(10px) grayscale(100%);
}